const{createApp:b,ref:a,onMounted:C,watch:O,computed:j}=Vue;b({setup(){const f=a([]),o=a({subject:"",body:""}),i=a(!1),u=a(null),m=a(1),l=a("all"),d=a("all"),p=a(""),n=a({current:1,last:1}),h=t=>{t>=1&&t<=n.value.last&&(m.value=t,s())},v=j(()=>{const t=n.value.last,r=n.value.current,e=2,c=[];for(let g=Math.max(1,r-e);g<=Math.min(t,r+e);g++)c.push(g);return c}),y=()=>{var t;return((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))??""},s=async()=>{i.value=!0;const t=new URLSearchParams({page:m.value,status:l.value||"",category:d.value||"",search:p.value||""}),e=await(await fetch(`/api/tickets?${t.toString()}`)).json();f.value=e.data.map(c=>({...c,category:c.category??""})),n.value={current:e.current_page,last:e.last_page},i.value=!1},T=async()=>{document.querySelector('meta[name="csrf-token"]').getAttribute("content"),(await fetch("/api/tickets",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":y()},body:JSON.stringify(o.value)})).ok&&(o.value.subject="",o.value.body="",await s())},w=async t=>{t.loading=!0,await fetch(`/api/tickets/${t.id}/classify`,{method:"POST",headers:{"X-CSRF-TOKEN":y()}}),setTimeout(s,1500)},S=async t=>{await fetch(`/api/tickets/${t.id}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":y()},body:JSON.stringify({status:t.status,category:t.category,note:t.note})}),u.value&&await s()},k=async t=>{const e=await(await fetch(`/api/tickets/${t}`)).json();u.value={...e,category:e.category??""}};return O([l,d,p],s),C(s),{tickets:f,form:o,loading:i,selectedTicket:u,statusFilter:l,categoryFilter:d,searchTerm:p,pagination:n,paginationRange:v,submitTicket:T,classify:w,updateTicket:S,loadTicketDetail:k,changePage:h}}}).mount("#app");
